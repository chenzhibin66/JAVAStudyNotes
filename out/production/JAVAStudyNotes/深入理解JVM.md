深入理解JVM

虚拟机

JRE由java API和JVM组成， JVM通过类加载器(Class Loader)加类应用，并通过java API进行执行。

虚拟机(VM:Virtual Machine)是通过软件模拟物理机器执行程序的执行器。最初java语言被设计为基于虚拟机器而非物理机器，重而实现WORA(一次编写，到处运行)的目的，尽管这个目标几乎被世人所遗忘，所有，JVM可以在所有的硬件环境上执行Java字节码而无调整java的执行模式。

JVM的基本特许：

- 基于栈的虚拟机：不同于Intel x86和ARM等比较流行的计算器处理器都是基于寄存器架构，JVM是基于栈执行的。

- 符号引用：除基本类型外的所有java类型(类和接口)都是通过符号引用取得关联的，而非显式的基于内存地址的引用。

- 垃圾回收机制：类的实例通过用户代码进行显示创建，但却通过垃圾回收机制自动销毁。

- 网络字节序：Java class文件的二进制表示使用的是基于网络的字节序，为了在使用小端的Intel x86平台和在使用了大端的RISC系列平台之间保持平台无关，必须要定义一个固定的字节序。JVM需选择了网络传输协议中使用的网络字节序，即基于大端的字节序。

  

Java字节码

JVM使用java字节码一种运行于jaba和机器语言的中级语言，以达到WORA的目的。Java字节码是部署Java程序的最小单元。java字节码是JVM的基本元素，JVM本身是一个用于执行java字节码的执行器，java编译器并不会把像c/c++那样把高级语言转为机器语言(cpu执行指令)，而是把开发者能理解的java语言转为JVM理解的java字节码。因为java字节码是平台无关的。

程序计数器

- 程序计数器是一块较小的内存空间，它可以看作是当前线程所执行的字节码的行号指示器。
- 程序计数器处于线程独占区
- 如果线程执行的是java方法，这个计数器记录的是正在执行的虚拟机字节码指令的地址。如果正在执行的是native方法，这个计数器的值为undefined
- 此区域是唯一一个在java虚拟机规范中没有规定任何OutOfMemoryError情况的区域